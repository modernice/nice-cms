package page

import (
	"github.com/modernice/goes/event"
	"github.com/modernice/nice-cms/static/page/field"
)

const (
	// Created means a Page was created.
	Created = "cms.static.page.created"

	// FieldsAdded means Fields were added to a Page.
	FieldsAdded = "cms.static.page.fields_added"

	// FieldsRemoved means Fields were removed from a Page.
	FieldsRemoved = "cms.static.page.fields_removed"

	// FieldUpdates means a Field value was updated.
	FieldUpdated = "cms.static.page.field_updated"
)

// CreatedData is the event data for Created.
type CreatedData struct {
	Name string
}

// FieldsAddedData is the event data for FieldsAdded.
type FieldsAddedData struct {
	Fields []field.Field
}

// FieldsRemovedData is the event data for FieldsRemoved.
type FieldsRemovedData struct {
	Fields []string
}

type FieldUpdatedData struct {
	Field   string
	Value   string
	Locales []string
}

// RegisterEvents register events into a registry.
func RegisterEvents(r *codec.GobRegistry) {
	r.GobRegister(Created, func() interface{} { return CreatedData{} })
	r.GobRegister(FieldsAdded, func() interface{} { return FieldsAddedData{} })
	r.GobRegister(FieldsRemoved, func() interface{} { return FieldsRemovedData{} })
	r.GobRegister(FieldUpdated, func() interface{} { return FieldUpdatedData{} })
}
